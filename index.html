<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Ignas Vyšniauskas" />
  <title>Palaipsninis tipavimas Pitone: Type Hints ir mypy - PyConLT 2015 - Ignas Vyšniauskas - </title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="reveal.js/css/reveal.css"/>
    <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; }
code > span.dt { color: #800000; }
code > span.dv { color: #0000ff; }
code > span.bn { color: #0000ff; }
code > span.fl { color: #800080; }
code > span.ch { color: #ff00ff; }
code > span.st { color: #dd0000; }
code > span.co { color: #808080; font-style: italic; }
code > span.al { color: #00ff00; font-weight: bold; }
code > span.fu { color: #000080; }
code > span.er { color: #ff0000; font-weight: bold; }
    </style>
    <link rel="stylesheet" href="reveal.js/css/theme/NONE.css" id="theme">
    <link rel="stylesheet" href="css/simple.css"/>
    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>
    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="palaipsninis-tipavimas-pitone-type-hints-ir-mypy" class="slide level1">
<h1>Palaipsninis tipavimas Pitone:<br /> Type Hints ir mypy</h1>
<p><em>Ignas Vyšniauskas</em> (<a href="https://twitter.com/yfyf">@yfyf</a>)</p>
<p><a href="http://pycon.lt">PyConLT 2015</a></p>
<p>2015-02-25</p>
</section>
<section id="whois-yfyf" class="slide level1">
<h1><code>/whois yfyf</code></h1>
<div class="fragment">
<p>“(Distributed) backend developer”</p>
</div>
<div class="fragment">
<table>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>$$$:</code></td>
<td style="text-align: left;">Erlang, Python</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>❤❤❤:</code></td>
<td style="text-align: left;">Haskell, Rust, Idris</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>???:</code></td>
<td style="text-align: left;">Type Theory, FP, PLT</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p><a href="http://functionalvilnius.lt">functionalvilnius.lt</a></p>
<figure>
<img src="img/fv.png" />
</figure>
</div>
</section>
<section id="įspėjimas" class="slide level1">
<h1>Įspėjimas:</h1>
<h2 id="kalba-yra-apie-python-3.x">Kalba yra apie <em>Python 3.x</em></h2>
</section>
<section id="pagrindinė-problema" class="slide level1">
<h1>Pagrindinė problema</h1>
<ul>
<li class="fragment">Mes mokam rašyti programas kurios daro už mus <em>viską</em>:
<ul>
<li class="fragment">Skraidina raketas</li>
<li class="fragment">Prognozuoja orus</li>
<li class="fragment">Vairuoja mašinas</li>
<li class="fragment">Kompiliuoja deklaratyvų kodą į mašininį</li>
</ul></li>
<li class="fragment">Bet…</li>
</ul>
</section>
<section id="pagrindinė-problema-1" class="slide level1">
<h1>Pagrindinė problema</h1>
<pre class="sourceCode python"><code class="sourceCode python">$ cat mismatch.py
<span class="kw">def</span> main():
    <span class="kw">return</span> <span class="st">&quot;☠&quot;</span> + <span class="ot">True</span>

main()</code></pre>
<div class="fragment">
<p>Nėra <em>jokio</em> konteksto kuriame šita programa būtų prasminga, tačiau…</p>
</div>
<div class="fragment">
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python3</span> -mcompileall mismatch.py<span class="kw">;</span> <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">Compiling</span> <span class="st">&#39;mismatch.py&#39;</span>...
<span class="kw">0</span>
$ <span class="kw">pyflakes3</span> mismatch.py<span class="kw">;</span> <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">0</span></code></pre>
</div>
<div class="fragment">
<p>Dabar yra 2015 metai. Kodėl mes nesugebam parašyti programų, kurios rastų trivialius bug’us <em>kitose programose</em>?</p>
<p><em>[Pavyzdys įkvėptas <a href="http://bob.ippoli.to/python-haskell-ep2014/">Bob Ippolito</a>]</em></p>
</div>
</section>
<section class="slide level1">

<figure>
<img src="img/fine.png" />
</figure>
<div class="fragment">
<h1>
No.
</h1>

</div>
<div class="fragment">
<p>Mes tikrai galim daugiau.</p>
<p><a href="http://gunshowcomic.com/648">(src)</a></p>
</div>
</section>
<section id="daugiau-problemų" class="slide level1">
<h1>Daugiau problemų</h1>
<pre class="sourceCode python"><code class="sourceCode python">&gt;&gt;&gt; <span class="dt">help</span>(<span class="dt">bool</span>)
<span class="kw">class</span> <span class="dt">bool</span>(<span class="dt">int</span>)
&lt;..&gt;
 |  The <span class="kw">class</span> <span class="dt">bool</span> is a subclass of the <span class="kw">class</span> <span class="dt">int</span>, and
    ****cannot be subclassed****.
&lt;..&gt;</code></pre>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">$ cat subclassing.py
<span class="kw">class</span> MegaBool(<span class="dt">bool</span>):
    <span class="kw">pass</span></code></pre>
</div>
<div class="fragment">
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">python3</span> -mcompileall subclassing.py<span class="kw">;</span> <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">Compiling</span> <span class="st">&#39;subclassing.py&#39;</span>...
<span class="kw">0</span>
$ <span class="kw">pyflakes3</span> subclassing.py<span class="kw">;</span> <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">0</span></code></pre>
</div>
</section>
<section class="slide level1">

<h3>
Mano (ne)mėgstamiausia problema (1/2)
</h3>

<pre class="sourceCode python"><code class="sourceCode python">Library     | <span class="kw">class</span> UserDB:
code        |     &lt;..&gt;
            |     <span class="kw">def</span> user_ids(<span class="ot">self</span>):
            |         <span class="kw">return</span> [user_id(x) <span class="kw">for</span> x in <span class="ot">self</span>.users()]</code></pre>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">Client      | user_ids = UserDB().user_ids()
code        | <span class="kw">if</span> (some_crazy_corner_case): user_ids.sort()</code></pre>
</div>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">Refactored  | <span class="kw">class</span> UserDB:
library     |     &lt;..&gt;
code        |     <span class="kw">def</span> user_ids(<span class="ot">self</span>):
            |         <span class="kw">return</span> <span class="dt">map</span>(user_id, <span class="ot">self</span>.users())</code></pre>
</div>
<div class="fragment">
<p>Klientinis kodas sprogsta:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ot">AttributeError</span>: <span class="st">&#39;map&#39;</span> <span class="dt">object</span> has no attribute <span class="st">&#39;sort&#39;</span></code></pre>
</div>
</section>
<section class="slide level1">

<h3>
Mano (ne)mėgstamiausia problema (2/2)
</h3>

<ul>
<li class="fragment">“Bit-rot”: net su 100% code-coverage, bug’as gali likti nepastebėtas labai ilgai: kodas veiks visur kur <code>list</code>’as tik iteruojamas.</li>
<li class="fragment">Bibliotekos kurėjui sunku trackinti visus API tipus kuriuos jis exposina<br /><em>“<code>list</code> of <code>user_ids</code>, or <code>iterable</code> of <code>user_ids</code>, whatever, maybe doesn’t quack like a <code>list</code>, but still feels like a <code>list</code>.”</em></li>
<li class="fragment">Refaktorinimas yra skausmingas.</li>
</ul>
<div class="fragment">
<br /><br />
<h3>
Statinis tipavimas padeda prižiūrėti kodą.
</h3>


</div>
</section>
<section id="tipavimas-terminologija" class="slide level1">
<h1>Tipavimas: terminologija</h1>
<pre><code>        Statinis tipavimas              Dinaminis tipavimas
               ||                               ||
               ||                               ||
               ||                               ||
        Tipai yra abstrakcijos          Tipai yra tag&#39;ai
               ||                               ||
               ||                               ||
               ||                               ||
        Compile-time checking           Run-time checking</code></pre>
</section>
<section id="pitonistai-myli-dinaminį-tipavimą" class="slide level1">
<h1>Pitonistai myli dinaminį tipavimą</h1>
<ul>
<li>Greitas prototipavimas</li>
<li>Duck typing</li>
<li>“Beginner friendly”</li>
<li>Dirty-hacks-when-needed</li>
</ul>
</section>
<section id="neapykanta-statiniam-tipavimui-12" class="slide level1">
<h1>Neapykanta statiniam tipavimui (1/2)</h1>
<div class="fragment">
<p>Pvz. 1:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="dt">int</span> intSquare(<span class="dt">int</span> a) { <span class="kw">return</span> a*a; }
<span class="dt">double</span> doubleSquare(<span class="dt">double</span> a) { <span class="kw">return</span> a*a; }
&lt;..&gt;</code></pre>
</div>
<div class="fragment">
<pre class="sourceCode C"><code class="sourceCode c"><span class="ot">#define SQUARE(a) ((a)*(a))</span></code></pre>
<p>Tipavimas C-šeimos kalbose yra visu pirma apie <em>memory-layout</em>.</p>
</div>
</section>
<section id="neapykanta-statiniam-tipavimui-22" class="slide level1">
<h1>Neapykanta statiniam tipavimui (2/2)</h1>
<p>Pvz. 2:</p>
<pre class="sourceCode Java"><code class="sourceCode java"><span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">int</span> FOO = <span class="dv">5</span>;</code></pre>
<pre class="sourceCode Java"><code class="sourceCode java">List&lt;String&gt; list = <span class="kw">new</span> ArrayList&lt;String&gt;();</code></pre>
<pre class="sourceCode Java"><code class="sourceCode java"><span class="dt">static</span> List&lt;List&lt;? <span class="kw">extends</span> Shape&gt;&gt;
    history = <span class="kw">new</span> ArrayList&lt;List&lt;? <span class="kw">extends</span> Shape&gt;&gt;();</code></pre>
<div class="fragment">
<p>Yra tam tikrų priežasčių nesimėgauti tokiu kodu.</p>
</div>
<div class="fragment">
<p>Modernios tipų sistemos (pvz. Haskell) turi tokių problemų daug mažiau.</p>
</div>
</section>
<section id="išeitis-palaipsninis-tipavimas-a.k.a.-gradual-typing" class="slide level1">
<h1>Išeitis: Palaipsninis Tipavimas<br /> (a.k.a. <em>Gradual Typing</em>)</h1>
<p>“Best of both worlds”</p>
<div class="fragment">
<ul>
<li>Visiškai <em>opt-in</em></li>
<li><em>“Imk tiek statinio tipavimo, kiek pats nori.”</em></li>
<li>Liepk kompileriui atsiknist.</li>
<li>Kalbos ekosistema gali nesikeisti.</li>
</ul>
</div>
</section>
<section id="palaipsninio-tipavimo-esmė" class="slide level1">
<h1>Palaipsninio tipavimo esmė</h1>
<ol type="1">
<li class="fragment">(Dinaminės) kalbos “static core” identifikavimas.</li>
<li class="fragment">Tipų priskirimas static core.</li>
<li class="fragment">“Catch-all” tipas dinaminėm kodo dalim.</li>
<li class="fragment">“Draugystė” tarp #2 ir #3</li>
<li class="fragment">Kodo anotavimas tipais.</li>
<li class="fragment">Tipų tikrinimas <em>kompiliavimo metu</em>.</li>
</ol>
</section>
<section id="hist" class="slide level1">
<h1>Truputis istorijos</h1>
<ul>
<li>2006: <em>“Gradual typing for functional languages.”</em> (J. G. Siek &amp; W. Taha)</li>
<li>2007: Erlang (<a href="http://learnyousomeerlang.com/dialyzer">Dialyzer</a> 1.7.1), <em>Success typing</em></li>
<li>2008: Racket (<a href="http://docs.racket-lang.org/ts-guide/">Typed Scheme</a>), <em>Occurance typing</em></li>
<li>2012: Clojure (<a href="http://typedclojure.org/">core.typed</a> 0.1)</li>
<li>2012: JavaScript (<a href="http://www.typescriptlang.org/">TypeScript</a>)</li>
<li>2014: PHP (<a href="http://hacklang.org/">Hack</a>)</li>
<li>2014: JavaScript (<a href="http://flowtype.org/">Flow</a>)</li>
<li>2014: <strong>Python</strong> (<a href="http://www.mypy-lang.org/">mypy</a> 0.1.0)</li>
<li>2016(?): Ruby? (<a href="https://bugs.ruby-lang.org/issues/9999">Feature #9999</a>)</li>
</ul>
<!--
# Palaipsninis tipavimas **nėra**:

* Run-time checking
* "Linting"
* Visų kintamųjų anotavimas
* Kiti siaubai
-->


</section>
<section id="pitono-kelias-link-palaipsninio-tipavimo" class="slide level1">
<h1>Pitono kelias link palaipsninio tipavimo</h1>
<ul>
<li>1999: Types SIG</li>
<li>2006: PEP 3107 (Function Annotations)</li>
<li>2013: mypy</li>
<li>2015 Sausis: PEP 484 (Type Hints)</li>
<li><em>2015 Rugsėjis: Python 3.5.0 final</em>, <code>typing</code> module</li>
</ul>
</section>
<section id="pep-3107-function-annotations" class="slide level1">
<h1>PEP 3107: Function Annotations</h1>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> foo(x, y, z=<span class="ot">True</span>):
    &lt;..&gt;</code></pre>
<div class="fragment">
<p><br /><br /></p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> foo(x: <span class="st">&quot;My favourite argument&quot;</span>,
        y: <span class="dt">int</span>,
        z: (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>) = <span class="ot">True</span>) -&gt; <span class="dv">42</span>:
    &lt;..&gt;</code></pre>
</div>
</section>
<section id="pep-484-type-hints" class="slide level1">
<h1>PEP 484: Type Hints</h1>
<ul>
<li><em>‘Python can be statically type checked’</em> (*drama*)</li>
<li>Function Annotations —&gt; Type Annotations</li>
<li>Tipų sistema ir jos sintaksė</li>
<li>Jokios naujos Pitono sintaksės</li>
<li>“Stub files”</li>
<li>Type-checker’iai yra <em>3rd-party</em></li>
</ul>
</section>
<section id="pep-484-tipų-sistema" class="slide level1">
<h1>PEP 484 tipų sistema</h1>
</section>
<section id="static-core-of-python" class="slide level1">
<h1>Static core of Python</h1>
<pre><code>&gt;&gt;&gt; import builtins
&gt;&gt;&gt; help(builtins)
&lt;..&gt;
bytearray           memoryview
bytes               property
classmethod         range
complex             reversed
dict                set
enumerate           slice
filter              staticmethod
float               str
frozenset           super
int                 tuple
    bool            type
list                zip
map</code></pre>
</section>
<section id="baziniai-tipai" class="slide level1">
<h1>Baziniai tipai</h1>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> increment(x: <span class="dt">int</span>) -&gt; <span class="dt">int</span>:
    <span class="kw">return</span> x + <span class="dv">1</span></code></pre>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">from</span> typing <span class="ch">import</span> List

Bone = <span class="dt">bytes</span>

<span class="kw">class</span> Dog:
    &lt;..&gt;
    <span class="kw">def</span> fetch(<span class="ot">self</span>) -&gt; Bone:
        &lt;..&gt;

<span class="kw">def</span> use_dog_army(dogs: List[Dog]) -&gt; List[Bone]:
    <span class="kw">return</span> [dog.fetch() <span class="kw">for</span> dog in dogs]</code></pre>
</section>
<section id="any-tipas" class="slide level1">
<h1><code>Any</code> tipas</h1>
<h2 id="grubiai">Grubiai:</h2>
<ul>
<li><code>isinstance(x, Any) == True</code></li>
<li><code>issubclass(y, Any) == True</code></li>
<li><code>isinstance(Any, z) == True</code></li>
<li><code>issubclass(Any, z) == True</code></li>
</ul>
<p><br /></p>
<pre class="sourceCode python"><code class="sourceCode python">$ cat dynamic.py
<span class="ch">from</span> typing <span class="ch">import</span> Any

<span class="kw">def</span> do_magic(dynamic_foo: Any) -&gt; Any:
    bah = dynamic_foo + <span class="dv">1</span>
    &lt;..&gt;
    dynamic_foo.sort()
    baz = dynamic_foo(<span class="st">&quot;Haha&quot;</span>)
    &lt;..&gt;
$ mypy dynamic.py; echo $?
<span class="dv">0</span></code></pre>
</section>
<section id="union-tipai" class="slide level1">
<h1>Union tipai</h1>
<pre class="sourceCode python"><code class="sourceCode python">IntOrFloat = Union[<span class="dt">int</span>, <span class="dt">float</span>]

<span class="kw">def</span> square(n: IntOrFloat) -&gt; IntOrFloat:
    <span class="kw">return</span> n*n</code></pre>
</section>
<section id="generics" class="slide level1">
<h1>Generics</h1>
<pre class="sourceCode python"><code class="sourceCode python">T = TypeVar(<span class="st">&#39;T&#39;</span>)

<span class="kw">def</span> reverse(foo: List[T]) -&gt; List[T]:
    <span class="kw">return</span> <span class="dt">list</span>(<span class="dt">reversed</span>(foo))</code></pre>
</section>
<section id="constrained-typevars" class="slide level1">
<h1>Constrained TypeVars</h1>
<pre class="sourceCode python"><code class="sourceCode python">T = TypeVar(<span class="st">&#39;T&#39;</span>, <span class="dt">str</span>, <span class="dt">bytes</span>)
<span class="co"># (same as T = AnyStr)</span>

<span class="kw">def</span> concat(a: T, b: T) -&gt; T:
    <span class="kw">return</span> a + b</code></pre>
</section>
<section id="stub-files" class="slide level1">
<h1>Stub files</h1>
<pre class="sourceCode python"><code class="sourceCode python">$ cat somemod.py
<span class="kw">class</span> Foo:
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, name: <span class="dt">str</span>):
        <span class="ot">self</span>.name = name
    <span class="kw">def</span> talk(<span class="ot">self</span>):
        <span class="kw">return</span> <span class="st">&quot;Hi, I am </span><span class="ot">%s</span><span class="st">&quot;</span> % <span class="ot">self</span>.name

$ cat somemod.pyi
<span class="kw">class</span> Foo:
    name = <span class="dt">str</span>
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, name: <span class="dt">str</span>) -&gt; <span class="ot">None</span>: <span class="kw">pass</span>
    <span class="kw">def</span> talk(<span class="ot">self</span>) -&gt; <span class="dt">str</span>: <span class="kw">pass</span></code></pre>
</section>
<section id="callable" class="slide level1">
<h1>Callable</h1>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> map_stupid(f: Callable[[A], B],
               things: Iterable[A]) -&gt; Iterable[B]:
    <span class="kw">return</span> (f(x) <span class="kw">for</span> x in things)</code></pre>
</section>
<section id="mypy" class="slide level1">
<h1>mypy</h1>
<ul>
<li><a href="http://mypy-lang.org/">http://mypy-lang.org/</a></li>
<li><p><a href="https://github.com/JukkaL/mypy">https://github.com/JukkaL/mypy</a></p></li>
<li>Type-checker’is Pitonui</li>
<li>“Type Hints compatible”</li>
<li>Nesubrendęs, bet aktyvus</li>
<li>Partial Python 2 compatibility</li>
<li><p>stub’ai 3.x ir 2.7 stdlib</p></li>
</ul>
</section>
<section id="mypy-naudojimas" class="slide level1">
<h1>mypy naudojimas</h1>
<p>mypy iš tikrųjų veikia.</p>
<ol type="1">
<li>pip install mypy-lang</li>
<li>Naudok.</li>
</ol>
</section>
<section id="mypy-naudojimo-pavyzdys-1" class="slide level1">
<h1>mypy naudojimo pavyzdys (1)</h1>
<pre class="sourceCode python"><code class="sourceCode python">$ cat mismatch-ann.py
<span class="ch">from</span> typing <span class="ch">import</span> Any

<span class="kw">def</span> main() -&gt; Any:
    <span class="kw">return</span> <span class="st">&quot;☠&quot;</span> + <span class="dv">3</span>

main()
$ mypy mismatch-ann.py
mismatch-ann.py: In function <span class="st">&quot;main&quot;</span>:
mismatch-ann.py, line <span class="dv">4</span>:
    Unsupported operand types <span class="kw">for</span> + (<span class="st">&quot;str&quot;</span> and <span class="st">&quot;int&quot;</span>)</code></pre>
</section>
<section id="mypy-naudojimo-pavyzdys-2" class="slide level1">
<h1>mypy naudojimo pavyzdys (2)</h1>
<pre class="sourceCode python"><code class="sourceCode python">$ cat subclassing.py
<span class="kw">class</span> MegaBool(<span class="dt">bool</span>):
    <span class="kw">pass</span>

$ mypy subclassing.py
subclassing.py, line <span class="dv">1</span>: <span class="st">&#39;bool&#39;</span> is not a valid base <span class="kw">class</span></code></pre>
</section>
<section id="mypy-naudojimo-pavyzdys-3" class="slide level1">
<h1>mypy naudojimo pavyzdys (3)</h1>
<pre class="sourceCode python"><code class="sourceCode python">    <span class="kw">def</span> user_ids(<span class="ot">self</span>) -&gt; List[<span class="dt">int</span>]:
        <span class="kw">return</span> [user_id(x) <span class="kw">for</span> x in <span class="ot">self</span>.users()]</code></pre>
<pre class="sourceCode python"><code class="sourceCode python">    <span class="kw">def</span> user_ids(<span class="ot">self</span>) -&gt; List[<span class="dt">int</span>]:
        <span class="kw">return</span> <span class="dt">map</span>(user_id, <span class="ot">self</span>.users())</code></pre>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">$ mypy lib-client.py
lib-client.py: In member <span class="st">&quot;user_ids&quot;</span> of <span class="kw">class</span> <span class="st">&quot;UserDB&quot;</span>:
lib-client.py, line <span class="dv">11</span>: Incompatible <span class="kw">return</span> value <span class="dt">type</span>:
    expected builtins.<span class="dt">list</span>[builtins.<span class="dt">int</span>],
    got typing.Iterator[builtins.<span class="dt">int</span>*]</code></pre>
</div>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">    <span class="kw">def</span> user_ids(<span class="ot">self</span>) -&gt; Iterable[<span class="dt">int</span>]:
        &lt;..&gt;
<span class="kw">def</span> main() -&gt; Any:
    user_ids = UserDB().user_ids()
    <span class="kw">if</span> (some_crazy_corner_case): user_ids.sort()</code></pre>
</div>
<div class="fragment">
<pre class="sourceCode python"><code class="sourceCode python">$ mypy lib-client.py
lib-client.py: In function <span class="st">&quot;main&quot;</span>:
lib-client.py, line <span class="dv">18</span>: Iterable[<span class="dt">int</span>] has no attribute <span class="st">&quot;sort&quot;</span></code></pre>
</div>
</section>
<section id="mypy-coverage" class="slide level1">
<h1>mypy coverage</h1>
<pre><code>$ mypy --html-report dir</code></pre>
</section>
<section id="dalykai-kurių-nespėjom-aptarti" class="slide level1">
<h1>Dalykai kurių nespėjom aptarti:</h1>
<ul>
<li>Stubgen</li>
<li>Kiti palaipsninių tipų panaudojimai:
<ul>
<li>Dokumentacija</li>
<li>Performance optimisations</li>
<li>Type-driven design</li>
<li>Safe coercions</li>
<li>Clean overloading</li>
<li>Run-time contract checking</li>
</ul></li>
<li>Structural subtyping</li>
</ul>
</section>
<section id="išvados" class="slide level1">
<h1>Išvados</h1>
<ul>
<li>Type Hints ir mypy galima pradėti naudoti jau šiandien!</li>
<li>Palaipsninis tipavimas <em>tikrai</em> padės jums rasti bug’us greičiau.</li>
<li>Ateitis: mypy integruotas į Pitoną?</li>
</ul>
</section>
<section id="klausimai" class="slide level1">
<h1>Klausimai?</h1>
</section>
<section id="references-12" class="slide level1">
<h1>References (1/2)</h1>
<ul>
<li><a href="https://www.python.org/dev/peps/pep-0483/">PEP 483 (Theory of gradual typing)</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0484/">PEP 484 (Type Hints)</a></li>
<li><a href="https://groups.google.com/forum/#!topic/python-ideas/Aa_7lf4jZ7w[1-25]">PEP 484 discussion</a></li>
<li><a href="https://github.com/ambv/typehinting">GH repo for prototype <code>typing</code> module</a></li>
<li><a href="http://mypy-lang.org/">mypy web</a> and <a href="https://github.com/JukkaL/mypy">repo</a></li>
<li><a href="http://www.mypy-lang.org/wiki/">mypy wiki</a></li>
<li><a href="http://www.mypy-lang.org/wiki/TypeChecker">mypy type checker info</a></li>
<li><a href="http://mypy.readthedocs.org/en/latest/generics.html">mypy generics</a></li>
<li><a href="http://wphomes.soic.indiana.edu/jsiek/what-is-gradual-typing/">What is gradual typing</a></li>
</ul>
</section>
<section id="references-22" class="slide level1">
<h1>References (2/2)</h1>
<ul>
<li><a href="https://github.com/samth/gradual-typing-bib">Gradual typing bibliography</a></li>
<li><a href="https://github.com/google/pytype/">Google pytype</a></li>
<li><a href="https://github.com/ceronman/typeannotations">typeannotations</a></li>
<li><a href="https://github.com/ashleyh/mypy-stubgen">stubgen</a></li>
<li><a href="https://github.com/JukkaL/mypy/blob/master/mypy/stubgen.py">mypy-stubgen</a></li>
<li><a href="https://www.python.org/community/sigs/retired/types-sig/">types SIG</a></li>
<li><a href="http://www.youtube.com/watch?v=2wDvzy6Hgxg">GvR on Type Hints @ PyCon2015</a></li>
<li><a href="https://www.youtube.com/watch?v=pJOmlFf5Je4">Bob Ippolito @ EuroPython 2014</a></li>
</ul>
</section>
    </div>
  </div>


  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: false,
        progress: true,
        history: true,
        center: true,
        transition: "none",

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
//          { src: 'reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; }, }
//          { src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
]});
    </script>
    </body>
</html>
